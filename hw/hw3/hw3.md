## 1.
### Q1：
分支指令的平均开销为：$1+3\times10\%+4\times10\%\times90\%1.66$周期
CPI为：$1\times 0.85 + 1.66\times 0.15 = 1.099$
### Q2：
采用固定2时钟周期延迟时，CPI为：$1 + 2\times 0.15 = 1.3$
采用分支预测执行速度更快。

## 2.
需要进行3次展开，展开后的代码如下：
```
addi    x4, x1, #800
foo:fld     F2, 0(x1)
    fld     F4, 8(x1)
    fld     F6, 16(x1)
    fmul.d  F2, F2, F0
    fmul.d  F4, F4, F0
    fmul.d  F6, F6, F0
    fld     F8, 0(x2)
    fld     F10, 8(x2)
    fld     F12, 16(x2)
    addi    x1, x1, #24
    fadd.d  F8, F8, F2
    fadd.d  F10, F10, F4
    fadd.d  F12, F12, F6
    addi    x2, x2, #24
    sltu    x3, x1, x4
    fsd     F8, -24(x2)
    fsd     F10, -16(x2)
    bnez    x3, foo
    fsd     F12, -8(x2)    
```

## 3.
|迭代次数|指令|发射周期|开始执行周期|存储器访问周期|写CDB周期|等待的事件|
|---|---|---|---|---|---|---|
|1|fld F2, 0(x1)|1|2|2|3|无|
|1|fmul.d F4, F2, F0|2|4|/|19|等待F2|
|1|fld F6, 0(x2)|3|4|4|5|无|
|1|fadd.d F6, F4, F6|4|20|/|30|等待F4|
|1|fsd F6, 0(x2)|5|31|31|/|等待F6|
|1|addi x1, x1, #8|6|7|8|/|无|
|1|addi x2, x2, #8|7|8|9|/|无|
|1|sltu x3, x1, x4|8|9|10|/|无|
|1|bnez x3, foo|9|11|/|/|等待x3|
|2|fld F2, 0(x1)|10|12|12|13|等待bnez|
|2|fmul.d F4, F2, F0|11|19|/|34|等待F2，等待乘法单元|
|2|fld F6, 0(x2)|12|13|13|14|无|
|2|fadd.d F6, F4, F6|13|35|/|45|等待F6，等待F4|
|2|fsd F6, 0(x2)|14|46|46|/|等待F6|
|2|addi x1, x1, #8|15|16|17|/|无|
|2|addi x2, x2, #8|16|17|18|/|无|
|2|sltu x3, x1, x4|17|18|19|/|无|
|2|bnez x3, foo|18|20|/|/|等待x3|
|3|fld F2, 0(x1)|19|21|21|22|等待bnez|
|3|fmul.d F4, F2, F0|20|34|/|49|等待F2，等待乘法单元|
|3|fld F6, 0(x2)|21|22|22|23|无|
|3|fadd.d F6, F4, F6|22|50|/|60|等待F6，等待F4|
|3|fsd F6, 0(x2)|23|61|61|/|等待F6|
|3|addi x1, x1, #8|24|25|26|/|无|
|3|addi x2, x2, #8|25|26|27|/|无|
|3|sltu x3, x1, x4|26|27|28|/|无|
|3|bnez x3, foo|27|29|/|/|等待x3|